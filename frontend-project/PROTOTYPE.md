# BloomSocial 前端原型文档

> 本文档用于 UI 设计参考，描述项目功能和各页面交互细节。

---

## 一、项目概述

### 1.1 一句话定义

**BloomSocial 是一个链上内容平台**：用户用钱包登录，作者发布内容，读者用代币「点赞/支持」，越早支持的人获得越多奖励。

### 1.2 核心玩法

```
作者发布内容 → 读者付费点赞 → 资金进入赏金池 → 内容结束后 → 作者和点赞者领取奖励
```

### 1.3 资金分配规则

| 角色 | 比例 | 说明 |
|-----|------|------|
| 作者 | 70% | 内容价值主要归属 |
| 点赞者 | 25% | 早期支持红利（按权重分配） |
| 协议 | 5% | 平台费用 |

### 1.4 早期支持者机制（核心卖点）

- 越早点赞，权重越高
- 后来的点赞者会给之前的人「分钱」
- 第 1 个点赞者权重最高，之后逐渐衰减
- 即使很晚点赞，也有最低 20% 的权重保底

---

## 二、用户角色

| 角色 | 行为 |
|-----|------|
| **作者** | 发布内容、设置点赞金额和有效期、领取作者奖励 |
| **点赞者** | 浏览内容、付费点赞、领取点赞奖励 |
| **访客** | 浏览内容（不连接钱包） |

> 同一用户可以同时是作者和点赞者

---

## 三、页面结构

```
/                    首页（内容发现）
/create              发布内容
/content/[id]        内容详情
/profile/[address]   用户主页（他人）
/my                  我的主页
```

---

## 四、全局组件

### 4.1 顶部导航栏 (Header)

**布局**：
```
[Logo] [发现] [发布] [我的]                    [连接钱包按钮]
```

**钱包按钮状态**：

| 状态 | 显示 |
|-----|------|
| 未连接 | `连接钱包` 按钮 |
| 已连接 | `0x1234...5678` + 头像 + 下拉菜单 |

**下拉菜单**：
- BLOOM 余额：`1,234.56 BLOOM`
- 我的主页
- 断开连接

---

### 4.2 交易状态 Toast

所有链上操作都需要显示交易状态：

| 状态 | 样式 | 文案示例 |
|-----|------|---------|
| 等待签名 | 蓝色 loading | 请在钱包中确认... |
| 处理中 | 蓝色 loading | 交易处理中... |
| 成功 | 绿色 ✓ | 点赞成功！ |
| 失败 | 红色 ✗ | 交易失败：余额不足 |

---

## 五、页面详情

---

### 5.1 首页 `/` - 内容发现

**页面目的**：展示平台所有内容，让用户发现值得支持的内容。

#### 页面布局

```
┌─────────────────────────────────────────────────────┐
│  [Header]                                           │
├─────────────────────────────────────────────────────┤
│                                                     │
│  发现内容                           [排序: 最新 ▼]  │
│                                                     │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐               │
│  │ 内容卡片 │ │ 内容卡片 │ │ 内容卡片 │               │
│  └─────────┘ └─────────┘ └─────────┘               │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐               │
│  │ 内容卡片 │ │ 内容卡片 │ │ 内容卡片 │               │
│  └─────────┘ └─────────┘ └─────────┘               │
│                                                     │
│              [加载更多] 或 无限滚动                  │
│                                                     │
└─────────────────────────────────────────────────────┘
```

#### 内容卡片设计

```
┌───────────────────────────────────────┐
│  [头像] 0x1234...5678                 │
│         作者地址                       │
├───────────────────────────────────────┤
│                                       │
│  内容预览文字（截取前 100 字）...       │
│                                       │
├───────────────────────────────────────┤
│  💰 赏金池        ❤️ 点赞数            │
│  1,234 BLOOM     56 人               │
├───────────────────────────────────────┤
│  ⏰ 剩余 2天3小时  |  [进行中] 绿色徽章  │
│  或                                   │
│  ⏰ 已于 3天前结束 |  [已结束] 灰色徽章  │
└───────────────────────────────────────┘
```

#### 卡片字段说明

| 字段 | 来源 | 说明 |
|-----|------|------|
| 作者地址 | content.author | 截取显示 `0x1234...5678` |
| 内容预览 | IPFS contentURI | 加载内容并截取前 100 字 |
| 赏金池 | authorPool + likerRewardPool | 格式化显示，带 BLOOM 单位 |
| 点赞数 | likeCount | 整数 |
| 状态 | 比较 deadline 和当前时间 | 进行中/已结束 |
| 剩余时间 | deadline - now | 倒计时格式 |

#### 交互

- 点击卡片 → 跳转到 `/content/[id]`
- 排序选项：最新、赏金池最高、点赞最多
- 支持分页或无限滚动

---

### 5.2 发布页 `/create` - 创建内容

**页面目的**：让作者发布新内容到链上。

#### 页面布局

```
┌─────────────────────────────────────────────────────┐
│  [Header]                                           │
├─────────────────────────────────────────────────────┤
│                                                     │
│  发布新内容                                          │
│                                                     │
│  ┌───────────────────────────────────────────────┐ │
│  │  内容正文                                      │ │
│  │  ┌─────────────────────────────────────────┐ │ │
│  │  │                                         │ │ │
│  │  │  [富文本编辑器 / Markdown 编辑器]        │ │ │
│  │  │                                         │ │ │
│  │  │  支持：标题、粗体、列表、代码块、图片     │ │ │
│  │  │                                         │ │ │
│  │  └─────────────────────────────────────────┘ │ │
│  └───────────────────────────────────────────────┘ │
│                                                     │
│  点赞金额                                           │
│  ┌─────────────────────┐                           │
│  │ 100                 │ BLOOM                     │
│  └─────────────────────┘                           │
│  💡 每位点赞者需支付的固定金额                       │
│                                                     │
│  有效期                                             │
│  ┌─────────────────────┐                           │
│  │ 7                   │ 天                        │
│  └─────────────────────┘                           │
│  💡 内容可接受点赞的时间窗口，到期后可领取奖励        │
│                                                     │
│  ─────────────────────────────────────────────      │
│                                                     │
│  预览                                               │
│  ┌───────────────────────────────────────────────┐ │
│  │  点赞金额：100 BLOOM                           │ │
│  │  有效期至：2024-03-20 18:00                    │ │
│  │  资金分配：作者 70% | 点赞者 25% | 协议 5%      │ │
│  └───────────────────────────────────────────────┘ │
│                                                     │
│                              [发布内容] 主按钮      │
│                                                     │
└─────────────────────────────────────────────────────┘
```

#### 表单字段

| 字段 | 类型 | 验证规则 | 说明 |
|-----|------|---------|------|
| 内容正文 | textarea/富文本 | 必填，至少 10 字 | 存储到 IPFS |
| 点赞金额 | number | 必填，> 0 | 单位 BLOOM |
| 有效期 | number | 必填，1-30 天 | 发布后不可修改 |

#### 发布流程

```
1. 用户填写表单
2. 点击「发布内容」
3. 上传内容到 IPFS → 获取 contentURI 和 contentHash
4. 调用合约 createContent(likeAmount, duration, contentURI, contentHash)
5. 等待交易确认
6. 成功后跳转到内容详情页
```

#### 状态显示

| 步骤 | Toast 提示 |
|-----|-----------|
| 上传 IPFS | "正在上传内容到 IPFS..." |
| 等待签名 | "请在钱包中确认交易..." |
| 交易处理中 | "交易处理中..." |
| 成功 | "发布成功！" + 跳转 |
| 失败 | 显示错误原因 |

---

### 5.3 内容详情页 `/content/[id]`

**页面目的**：查看内容详情，进行点赞/领取奖励操作。

#### 页面布局

```
┌─────────────────────────────────────────────────────┐
│  [Header]                                           │
├─────────────────────────────────────────────────────┤
│                                                     │
│  ← 返回                                             │
│                                                     │
│  ┌───────────────────────────────────────────────┐ │
│  │  [头像] 0x1234...5678        [关注] / [已关注] │ │
│  │         作者地址                               │ │
│  └───────────────────────────────────────────────┘ │
│                                                     │
│  ┌───────────────────────────────────────────────┐ │
│  │                                               │ │
│  │  内容正文区域                                  │ │
│  │  （从 IPFS 加载的完整内容）                    │ │
│  │                                               │ │
│  │  支持 Markdown 渲染                           │ │
│  │                                               │ │
│  └───────────────────────────────────────────────┘ │
│                                                     │
│  ┌─────────────┬─────────────┬─────────────┬─────┐ │
│  │ 💰 赏金池    │ ❤️ 点赞数    │ 💵 点赞价格  │ ⏰  │ │
│  │ 1,234       │ 56          │ 100         │剩余 │ │
│  │ BLOOM       │ 人          │ BLOOM       │2天  │ │
│  └─────────────┴─────────────┴─────────────┴─────┘ │
│                                                     │
│  ════════════════════════════════════════════════  │
│                                                     │
│  【根据用户身份和内容状态，显示不同的操作区】         │
│                                                     │
└─────────────────────────────────────────────────────┘
```

#### 操作区 - 根据状态动态显示

**情况 1：内容进行中 + 用户未点赞**
```
┌───────────────────────────────────────────────────┐
│                                                   │
│  支持这篇内容                                      │
│                                                   │
│  点赞需支付 100 BLOOM                              │
│                                                   │
│            [❤️ 点赞支持]  主按钮，高亮             │
│                                                   │
└───────────────────────────────────────────────────┘
```

**情况 2：内容进行中 + 用户已点赞**
```
┌───────────────────────────────────────────────────┐
│                                                   │
│  ✓ 你已点赞支持                                   │
│                                                   │
│  你的点赞顺序：第 5 位                             │
│  你的权重占比：18.2%                              │
│                                                   │
│  ┌───────────────────────────────────────────┐   │
│  │  📈 预估可领取奖励                         │   │
│  │                                           │   │
│  │      23.5 BLOOM                           │   │
│  │                                           │   │
│  │  💡 此金额会随新点赞者加入而增长            │   │
│  └───────────────────────────────────────────┘   │
│                                                   │
│  ⏰ 内容将于 2天3小时 后结束，届时可领取奖励       │
│                                                   │
└───────────────────────────────────────────────────┘
```

**情况 3：内容已结束 + 用户是作者（未领取）**
```
┌───────────────────────────────────────────────────┐
│                                                   │
│  🎉 内容已结束，可以领取奖励了！                   │
│                                                   │
│  ┌───────────────────────────────────────────┐   │
│  │  作者奖励                                  │   │
│  │                                           │   │
│  │      863.8 BLOOM                          │   │
│  │      (赏金池的 70%)                        │   │
│  │                                           │   │
│  │           [领取作者奖励]                   │   │
│  └───────────────────────────────────────────┘   │
│                                                   │
└───────────────────────────────────────────────────┘
```

**情况 4：内容已结束 + 用户是点赞者（未领取）**
```
┌───────────────────────────────────────────────────┐
│                                                   │
│  🎉 内容已结束，可以领取奖励了！                   │
│                                                   │
│  ┌───────────────────────────────────────────┐   │
│  │  你的点赞奖励                              │   │
│  │                                           │   │
│  │      28.5 BLOOM                           │   │
│  │      (你的权重: 18.2%)                     │   │
│  │                                           │   │
│  │           [领取点赞奖励]                   │   │
│  └───────────────────────────────────────────┘   │
│                                                   │
└───────────────────────────────────────────────────┘
```

**情况 5：已领取**
```
┌───────────────────────────────────────────────────┐
│                                                   │
│  ✓ 奖励已领取                                     │
│                                                   │
│  你已领取 28.5 BLOOM                              │
│                                                   │
└───────────────────────────────────────────────────┘
```

**情况 6：用户既是作者又是点赞者**
```
┌───────────────────────────────────────────────────┐
│                                                   │
│  🎉 内容已结束，可以领取奖励了！                   │
│                                                   │
│  ┌─────────────────┐  ┌─────────────────┐        │
│  │ 作者奖励        │  │ 点赞奖励        │        │
│  │ 863.8 BLOOM     │  │ 28.5 BLOOM      │        │
│  │ [领取]          │  │ [领取]          │        │
│  └─────────────────┘  └─────────────────┘        │
│                                                   │
└───────────────────────────────────────────────────┘
```

#### 点赞流程

```
用户点击「点赞支持」
    ↓
检查 BLOOM 授权额度
    ↓
[额度不足] → 发起 approve 交易 → 等待确认
    ↓
发起 like 交易
    ↓
等待确认
    ↓
刷新页面数据，显示「已点赞」状态
```

---

### 5.4 用户主页 `/profile/[address]`

**页面目的**：查看某个用户的公开资料和内容。

#### 页面布局

```
┌─────────────────────────────────────────────────────┐
│  [Header]                                           │
├─────────────────────────────────────────────────────┤
│                                                     │
│  ┌───────────────────────────────────────────────┐ │
│  │                                               │ │
│  │  [大头像]                                     │ │
│  │                                               │ │
│  │  0x1234...5678                                │ │
│  │                                               │ │
│  │  ┌─────────┐ ┌─────────┐ ┌─────────┐        │ │
│  │  │ 12      │ │ 56      │ │ 1,234   │        │ │
│  │  │ 内容    │ │ 粉丝    │ │ BLOOM   │        │ │
│  │  │         │ │         │ │ 总收益  │        │ │
│  │  └─────────┘ └─────────┘ └─────────┘        │ │
│  │                                               │ │
│  │                    [关注] / [已关注] / [取关] │ │
│  │                                               │ │
│  └───────────────────────────────────────────────┘ │
│                                                     │
│  ────────────────────────────────────────────────  │
│                                                     │
│  Ta 发布的内容                                      │
│                                                     │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐               │
│  │ 内容卡片 │ │ 内容卡片 │ │ 内容卡片 │               │
│  └─────────┘ └─────────┘ └─────────┘               │
│                                                     │
│  暂无更多内容                                       │
│                                                     │
└─────────────────────────────────────────────────────┘
```

#### 数据来源

| 字段 | 来源 |
|-----|------|
| 头像 | 根据地址生成（如 Jazzicon） |
| 内容数 | User.contentsCreated (The Graph) |
| 粉丝数 | User.followersCount (The Graph) |
| 总收益 | User.totalEarned (The Graph) |
| 发布的内容 | 查询 author = address 的 contents |

#### 关注交互

| 当前状态 | 按钮显示 | 点击操作 |
|---------|---------|---------|
| 未关注 | `关注` | 调用 follow() |
| 已关注 | `已关注` (hover 变 `取消关注`) | 调用 unfollow() |
| 是自己 | 不显示按钮 | - |

---

### 5.5 我的主页 `/my`

**页面目的**：查看和管理自己的内容、点赞记录、收益。

#### 页面布局

```
┌─────────────────────────────────────────────────────┐
│  [Header]                                           │
├─────────────────────────────────────────────────────┤
│                                                     │
│  我的主页                                           │
│                                                     │
│  ┌─────────────────────────────────────────────────┐
│  │                                                 │
│  │  ┌─────────────┐ ┌─────────────┐ ┌───────────┐ │
│  │  │ 💰 总收益    │ │ 🎁 可领取    │ │ ✓ 已领取  │ │
│  │  │ 1,234       │ │ 56.7        │ │ 1,177.3   │ │
│  │  │ BLOOM       │ │ BLOOM       │ │ BLOOM     │ │
│  │  └─────────────┘ └─────────────┘ └───────────┘ │
│  │                                                 │
│  └─────────────────────────────────────────────────┘
│                                                     │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐            │
│  │ 我的内容  │ │ 我的点赞  │ │ 我的关注  │            │
│  └──────────┘ └──────────┘ └──────────┘            │
│                                                     │
│  ════════════════════════════════════════════════  │
│                                                     │
│  【Tab 1: 我的内容】                                │
│                                                     │
│  ┌─────────────────────────────────────────────────┐
│  │ 内容标题预览...                    [进行中]     │
│  │ 赏金池: 500 BLOOM | 点赞: 23人                  │
│  │ 剩余 1天5小时                                   │
│  ├─────────────────────────────────────────────────┤
│  │ 内容标题预览...                    [已结束]     │
│  │ 赏金池: 1,200 BLOOM | 点赞: 89人                │
│  │ 可领取: 840 BLOOM         [领取作者奖励]        │
│  └─────────────────────────────────────────────────┘
│                                                     │
│  【Tab 2: 我的点赞】                                │
│                                                     │
│  ┌─────────────────────────────────────────────────┐
│  │ 内容标题预览...              by 0xabcd...       │
│  │ 我的顺序: 第3位 | 权重: 22.5%     [进行中]     │
│  │ 预估奖励: 15.6 BLOOM                            │
│  ├─────────────────────────────────────────────────┤
│  │ 内容标题预览...              by 0xefgh...       │
│  │ 我的顺序: 第1位 | 权重: 35.2%     [已结束]     │
│  │ 可领取: 28.5 BLOOM            [领取点赞奖励]    │
│  └─────────────────────────────────────────────────┘
│                                                     │
│  【Tab 3: 我的关注】                                │
│                                                     │
│  ┌───────────────────────┐ ┌───────────────────────┐
│  │ [头像] 0x1234...      │ │ [头像] 0x5678...      │
│  │ 12 内容 | 100 粉丝    │ │ 5 内容 | 50 粉丝     │
│  │ [已关注]              │ │ [已关注]              │
│  └───────────────────────┘ └───────────────────────┘
│                                                     │
└─────────────────────────────────────────────────────┘
```

#### 收益统计卡片

| 指标 | 计算方式 |
|-----|---------|
| 总收益 | 来自 The Graph User.totalEarned |
| 可领取 | 遍历所有已结束但未领取的内容，求和 |
| 已领取 | 总收益 - 可领取（或单独追踪） |

#### Tab 内容

**Tab 1: 我的内容**
- 查询：author = 当前用户地址
- 显示：标题、状态、赏金池、点赞数
- 操作：已结束未领取的显示「领取作者奖励」按钮

**Tab 2: 我的点赞**
- 查询：用户点赞过的所有内容
- 显示：内容标题、作者、我的点赞顺序、权重、预估/可领取奖励
- 操作：已结束未领取的显示「领取点赞奖励」按钮

**Tab 3: 我的关注**
- 查询：用户关注的所有地址
- 显示：头像、地址、内容数、粉丝数
- 操作：点击跳转到用户主页

---

## 六、特殊状态处理

### 6.1 未连接钱包

在需要登录的页面（发布、我的主页）显示：

```
┌───────────────────────────────────────┐
│                                       │
│  🔗 请先连接钱包                       │
│                                       │
│  连接钱包后可以：                       │
│  • 发布内容                            │
│  • 点赞支持                            │
│  • 领取奖励                            │
│                                       │
│         [连接钱包]                     │
│                                       │
└───────────────────────────────────────┘
```

### 6.2 加载状态

所有数据加载时显示骨架屏：

```
┌───────────────────────────────────────┐
│  ████████████████████                 │
│  ████████████                         │
│  ██████████████████████████████████   │
│  ██████████████████████████████████   │
│  ████████████████                     │
└───────────────────────────────────────┘
```

### 6.3 空状态

| 场景 | 显示 |
|-----|------|
| 首页无内容 | "还没有内容，成为第一个发布者！[去发布]" |
| 用户无内容 | "Ta 还没有发布内容" |
| 我的点赞为空 | "你还没有点赞过任何内容，[去发现]" |
| 我的关注为空 | "你还没有关注任何人" |

### 6.4 错误状态

```
┌───────────────────────────────────────┐
│                                       │
│  ❌ 加载失败                           │
│                                       │
│  网络错误，请检查网络连接               │
│                                       │
│         [重试]                        │
│                                       │
└───────────────────────────────────────┘
```

---

## 七、响应式设计要点

### 桌面端 (≥1024px)
- 内容列表：3 列网格
- 详情页：左侧内容 + 右侧操作栏
- 导航：完整显示所有选项

### 平板端 (768px - 1023px)
- 内容列表：2 列网格
- 详情页：单列，操作区在内容下方
- 导航：完整显示

### 移动端 (<768px)
- 内容列表：单列
- 详情页：单列
- 导航：汉堡菜单
- 按钮：全宽，增大点击区域

---

## 八、核心交互流程图

### 8.1 点赞流程

```
用户点击「点赞」
      │
      ▼
  ┌─────────┐
  │检查授权  │
  └────┬────┘
       │
   ┌───┴───┐
   ▼       ▼
[已授权] [未授权]
   │       │
   │       ▼
   │   发起 approve
   │       │
   │       ▼
   │   等待确认
   │       │
   ◀───────┘
   │
   ▼
发起 like 交易
   │
   ▼
等待确认
   │
   ▼
更新 UI
```

### 8.2 发布流程

```
填写表单
   │
   ▼
点击「发布」
   │
   ▼
上传 IPFS
   │
   ▼
获取 CID + Hash
   │
   ▼
调用 createContent
   │
   ▼
等待确认
   │
   ▼
跳转详情页
```

---

## 九、设计建议

### 9.1 配色方案

| 用途 | 建议色值 | 说明 |
|-----|---------|------|
| 主色 | #10B981 (绿) | 正面操作（点赞、领取） |
| 强调 | #6366F1 (紫) | 次要操作 |
| 警告 | #F59E0B (橙) | 提示信息 |
| 错误 | #EF4444 (红) | 错误状态 |
| 背景 | #F9FAFB | 页面背景 |
| 卡片 | #FFFFFF | 卡片背景 |

### 9.2 字体层级

| 层级 | 用途 | 大小 |
|-----|------|------|
| H1 | 页面标题 | 24-32px |
| H2 | 区块标题 | 18-20px |
| Body | 正文 | 14-16px |
| Small | 辅助文字 | 12px |

### 9.3 关键数字显示

- BLOOM 金额：使用千分位分隔符，如 `1,234.56 BLOOM`
- 百分比：保留一位小数，如 `18.2%`
- 时间：人性化显示，如 `2天3小时` 或 `3分钟前`
- 地址：截取显示，如 `0x1234...5678`

---

## 十、优先级建议

### P0 - 必须实现
- 首页内容列表
- 内容详情页（查看 + 点赞 + 领取）
- 钱包连接

### P1 - 重要功能
- 发布内容页
- 我的主页（我的内容 + 我的点赞）
- 交易状态 Toast

### P2 - 增强功能
- 用户主页
- 关注/取关
- 排序筛选

### P3 - 锦上添花
- 搜索功能
- 暗色模式
- 动画效果
